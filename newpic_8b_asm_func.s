;==========================================================================
; DEMONSTRATION OF RESET OPERATION
; ROTATING A LED ON PORT B FROM RIGHT TO LEFT THEN FROM LEFT TO RIGHT 
; 3 TIMES THEN FLASH ALL LEDS 10 TIMES THEN OFF 
; THE OPERATION IS REPEATED THE PUSHBUTTON CONNECTED TO THE MCLR INPUT IS 
; PUSHED 
; AUTHOR : DR. IYAD JAFAR
; MODIFIED : 25/2/2012
; =========================================================================

			#include P16F84A.INC

COUNTER1 	EQU		0X20
COUNTER2 	EQU		0X21
COUNT1		EQU		0X22
COUNT2		EQU		0X23


			ORG		0X0000
			GOTO	START 
			ORG		0X0004
ISR			GOTO	ISR	
			
START		BSF		STATUS, RP0
			CLRF	TRISB
			BCF		STATUS, RP0
			

			MOVLW	D'3'
			MOVWF	COUNT1
			CLRF	PORTB
OUTER		BCF		STATUS, C
			MOVLW	D'8'
			MOVWF	COUNT2
			CLRF	PORTB
			BSF		PORTB, 0
			CALL	DELAY
LEFT		RLF		PORTB, F
			CALL	DELAY
			DECFSZ	COUNT2, F
			GOTO	LEFT
			BCF		STATUS, C
			MOVLW	D'8'
			MOVWF	COUNT2
			CLRF	PORTB
			BSF		PORTB, 7
			CALL	DELAY
RIGHT		RRF		PORTB, F
			CALL	DELAY
			DECFSZ	COUNT2, F
			GOTO	RIGHT	
			DECFSZ	COUNT1, F
			GOTO	OUTER
			
			MOVLW	0XFF
			MOVWF	PORTB
			MOVLW	10
			MOVWF	COUNT1
FLASH		CALL	DELAY
			CALL	DELAY
			COMF	PORTB, F
			DECFSZ	COUNT1, F
			GOTO	FLASH
			CLRF	PORTB
			;GOTO	START
LOOP		GOTO	LOOP

DELAY		MOVLW	D'255'
			MOVWF	COUNTER1 
			MOVWF	COUNTER2
L1			NOP
			NOP
			NOP
			DECFSZ	COUNTER1, F
			GOTO	L1
			DECFSZ	COUNTER2, F
			GOTO	L1
			RETURN

			END